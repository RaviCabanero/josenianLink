<ion-header class="custom-header">
  <div class="header-bar">
    <div class="logo-title">
      <strong class="logo-green">JOSENIAN</strong><span class="logo-yellow">LINK</span> ðŸ”—
    </div>
    <div class="header-actions">
      <ion-button fill="clear" class="header-button" (click)="navigateToSettings()">
        <ion-icon name="settings" slot="icon-only"></ion-icon>
      </ion-button>
      <ion-button fill="clear" class="logout-button" (click)="logout()">
        Log Out
      </ion-button>
    </div>
  </div>
</ion-header>

<ion-content class="alumni-content">
  <div class="alumni-container">
    <!-- Header Section -->
    <div class="alumni-header">
      <h1>Alumni Directory</h1>
      <p class="subtitle">Connect with fellow USJR graduates</p>
    </div>

    <!-- Search and Filter Bar -->
    <div class="search-filter-bar">
      <ion-searchbar 
        placeholder="Search by name, program, or year" 
        class="search-bar"
        animated
        debounce="300"
        [(ngModel)]="searchTerm"
        (ionInput)="filterAlumni()">
      </ion-searchbar>
      <ion-button fill="outline" class="filter-btn" (click)="openFilterModal()">
        <ion-icon name="filter-outline" slot="start"></ion-icon>
        Filter
      </ion-button>
    </div>

    <!-- Alumni Grid -->
    <div class="alumni-grid" *ngIf="!loading">
      <div class="alumni-card-enhanced" *ngFor="let alumni of filteredAlumni" (click)="viewAlumniProfile(alumni)">
        <div class="alumni-card-content">
          <!-- Left side: Circular Image -->
          <div class="alumni-avatar-circle">
            <img [src]="alumni.photo || 'assets/default-avatar.png'" [alt]="alumni.name">
            <div class="online-indicator" *ngIf="alumni.isOnline"></div>
          </div>

          <!-- Right side: Alumni Information -->
          <div class="alumni-info-enhanced">
            <div class="name-section">
              <span class="first-name">{{ getFirstName(alumni.name) }}</span>
              <span class="last-name">{{ getLastName(alumni.name) }}</span>
            </div>

            <div class="details-section">
              <div class="course-id-row">
                <span class="course-badge">{{ alumni.program }}</span>
                <span class="id-number">ID: {{ alumni.idNumber || 'N/A' }}</span>
              </div>
              <p class="graduation-year">Class of {{ alumni.yearGraduated }}</p>
            </div>

            <div class="contact-section" *ngIf="alumni.location">
              <ion-icon name="location-outline"></ion-icon>
              <span>{{ alumni.location }}</span>
            </div>
          </div>
        </div>

        <!-- Action buttons -->
        <div class="alumni-actions">
          <ion-button fill="clear" size="small" (click)="sendMessage(alumni, $event)" class="action-btn">
            <ion-icon name="chatbubble-outline"></ion-icon>
          </ion-button>
          <ion-button fill="clear" size="small" (click)="viewProfile(alumni, $event)" class="action-btn">
            <ion-icon name="person-outline"></ion-icon>
          </ion-button>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div class="loading-state" *ngIf="loading">
      <ion-spinner name="crescent"></ion-spinner>
      <p>Loading alumni directory...</p>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!loading && filteredAlumni.length === 0">
      <ion-icon name="people-outline"></ion-icon>
      <h3>No Alumni Found</h3>
      <p *ngIf="searchTerm">Try adjusting your search criteria</p>
      <p *ngIf="!searchTerm">No alumni profiles available at the moment</p>
    </div>
  </div>
</ion-content>

<!-- Filter Modal -->
<ion-modal [isOpen]="isFilterModalOpen" (didDismiss)="closeFilterModal()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>Filter Alumni</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="closeFilterModal()">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content class="filter-modal-content">
      <div class="filter-form">
        <!-- Program Filter -->
        <div class="filter-section">
          <h4>Program</h4>
          <ion-select [(ngModel)]="filters.program" placeholder="Select Program" multiple>
            <ion-select-option value="BSIT">BSIT</ion-select-option>
            <ion-select-option value="BSCS">BSCS</ion-select-option>
            <ion-select-option value="BSN">BSN</ion-select-option>
            <ion-select-option value="BSBA">BSBA</ion-select-option>
            <ion-select-option value="BSED">BSED</ion-select-option>
          </ion-select>
        </div>

        <!-- Year Filter -->
        <div class="filter-section">
          <h4>Graduation Year</h4>
          <ion-range 
            [(ngModel)]="filters.yearRange" 
            min="2000" 
            max="2024" 
            dual-knobs="true"
            pin="true">
          </ion-range>
          <div class="year-labels">
            <span>{{ filters.yearRange.lower }}</span>
            <span>{{ filters.yearRange.upper }}</span>
          </div>
        </div>

        <!-- Location Filter -->
        <div class="filter-section">
          <h4>Location</h4>
          <ion-input 
            [(ngModel)]="filters.location" 
            placeholder="Enter city or country">
          </ion-input>
        </div>

        <!-- Action Buttons -->
        <div class="filter-actions">
          <ion-button expand="block" fill="outline" (click)="clearFilters()">
            Clear Filters
          </ion-button>
          <ion-button expand="block" (click)="applyFilters()">
            Apply Filters
          </ion-button>
        </div>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>

<ion-footer class="modern-footer">
  <ion-toolbar>
    <div class="footer-buttons">
      <ion-button fill="clear" routerLink="/home" class="footer-nav-btn">
        <div class="nav-content">
          <ion-icon name="home"></ion-icon>
          <span class="nav-label">Home</span>
        </div>
      </ion-button>
      <ion-button fill="clear" routerLink="/events" class="footer-nav-btn">
        <div class="nav-content">
          <ion-icon name="calendar"></ion-icon>
          <span class="nav-label">Events</span>
        </div>
      </ion-button>
      <ion-button fill="clear" routerLink="/notifications" class="footer-nav-btn">
        <div class="nav-content">
          <ion-icon name="notifications"></ion-icon>
          <span class="nav-label">Notifications</span>
        </div>
      </ion-button>
      <ion-button fill="clear" routerLink="/profile" class="footer-nav-btn">
        <div class="nav-content">
          <ion-icon name="person"></ion-icon>
          <span class="nav-label">Profile</span>
        </div>
      </ion-button>
      <ion-button fill="clear" routerLink="/messages" class="footer-nav-btn">
        <div class="nav-content">
          <ion-icon name="chatbox-ellipses"></ion-icon>
          <span class="nav-label">Messages</span>
        </div>
      </ion-button>
    </div>
  </ion-toolbar>
</ion-footer>
